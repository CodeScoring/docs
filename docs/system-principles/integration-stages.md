---
hide:
  - footer
---

# Этапы интеграции системы

## Этап поступления заимствованных компонентов

![Firewall](/assets/img/integration/integration-stage-firewall.png)

Для обеспечения гарантии доступности и ускорения процессов сборки программного обеспечения, в разработке применяются промежуточные хранилища программных компонентов, они же **прокси-репозитории**. Обычно прокси-репозитории размещаются внутри защищенного контура Организации и обеспечивают процессы кэширования используемых разработчиками программных библиотек. Дополнительно, эти хранилища могут использоваться для хранения собственных версий сборок и модулей составляющих программные продукты Организации.

Лидерами данного класса решений являются такие системы как **Nexus Repository Manager** (от компании Sonatype, есть бесплатная открытая версия) и **JFrog Artifactory PRO** (от компании JFrog, есть также бесплатная версия, но она не поддерживает модули расширений, которые добавляют функции дополнительных проверок). На российском рынке явных аналогов не представлено.

Для проверки компонентов поступающих и, в последующем использующихся разработчиками, применяются системы проверки Open Source (класс решений **OSA**). Такие системы позволяют «на лету» производить проверку использующихся компонентов на предмет соответствия настроенным политикам безопасности.

Решение CodeScoring обеспечивает такую интеграцию с обеими представленными системами при помощи специального плагина-расширения **CodeScoring OSS Firewall**. Задача плагина — на каждое обращение к хранящемуся компоненту выполнять проверку на соответствие настроенным политикам (policy compliance) и в случае несоответствия — выполнять его блокирование на скачивание с опциональной возможностью полного удаления из хранилища. Такой подход позволяет не допустить появления новых уязвимых компонентов в хранилищах артефактов, а также избежать ситуаций, когда со временем уязвимость была выявлена, а компонент был предварительно одобрен.

**Лучшие практики**: при выстраивании всех этапов безопасной разработки  SDL  рекомендуется не усложнять политики безопасности применяемые для прокси-стадии, т.к. если «закрутить гайки», можно получить сильный конфликт с разработчиками из-за частых блокировок. Как правило, политики настраиваются на особо опасные характеристики анализируемых компонентов (наличие вредоносного кода или крайне высокая критичность уязвимости: **CVSS Score** > 9 . Таким образом система играет роль «фильтра первичной очистки» от грубых нарушений безопасности.

## Этап сборки программных продуктов

![CI](/assets/img/integration/integration-stage-ci.png)
	
Для обеспечения сборки программных продуктов разработчиками применяются средства автоматизации конвейера непрерывной интеграции **CI** (**Continuous Integration**). Задача конвейера — обеспечить сборку программного продукта согласно настроенным инструкциям из доступных артефактов: собственный код (компоненты) + сторонние компоненты. Инструкции выполняются по шагам сборки (steps).	

На шаге перед конечной сборкой программного обеспечения обычно встраиваются: 

- проверки сторонних компонентов SCA;
- композиционный анализ программного обеспечения);
- проверки собственного кода (**SAST**, статическое тестирование приложения на безопасность).

SCA системы обеспечивают задачу инвентаризации используемых компонентов, формирование реестра компонентных связей **SBoM** (**Software Bill of Materials**), идентификацию в найденных компонентах известных уязвимостей и определение лицензий и лицензионной чистоты.	

Решение CodeScoring обеспечивает **три режима идентификации сторонних компонентов** в анализируемой кодовой базе: 

- разбор манифестов (списки зависимостей, формируемые разработчиками в ручном или автоматическом режимах);
- разрешение транзитивных зависимостей (зависимости зависимостей, которые «привносятся» зависимостями первого уровня)
- идентификация Open Source включений (ситуация когда сторонний компонент физически встраивается в собственную разработку Организации и не указывается разработчиками как используемый напрямую).	

В рамках этапа сборки и в целях инвентаризации собираемого приложения, система CodeScoring применяет специального агента, который запускается на шаге проверки безопасности в CI. Агент проверяет идентифицированные компоненты на соответствие настроенным политикам безопасности для выбранного продукта и, в случае несоответствия политикам с блокирующим статусом, возвращает соответствующий код ошибки, который сигнализирует об остановке сборки. Опционально, проверка агентом может быть запущена на локальной машине разработчика.				

**Лучшие практики**: на этапе сборки программных продуктов, политики безопасности должны быть тщательно продуманы в контексте последующей среды применения сборки. Отдельные типы уязвимостей не страшны в закрытом контуре, а для отдельных видов установок могут быть критичны уязвимости с низкой оценкой, но отдельного типа дефекта **CWE** (**Common Weakness Enumeration**). На этом этапе также важно отсеивать компоненты либо не обладающие лицензиями или же с лицензиями которые накладывают сильные ограничения на возможности распространение продукта, чтобы избежать исправления в ситуации «компонента не подходит по лицензии, давайте ее заменим, а тут и половину проекта переписывать нужно». 

## Этап разработки/сопровождения программного кода

![Development](/assets/img/integration/integration-stage-development.png)

Для разработки программного обеспечения применяются системы версионирования исходного кода (наиболее распространенная сегодня — git). Хранение версионируемых проектов (репозиториев) производится в **VCS** (**Version Control System**). Самые популярные на сегодня системы хранения репозиториев: **Github**, **Gitlab**, **Bitbucket** и **Azure DevOps**. Вендоры этих систем также предоставляют версии для on-premise установки в защищенном контуре Организации. Наиболее распространенная система на российском рынке — **Gitlab Community Edition**, открытое и бесплатное решение.	

Разрабатываемые исходные коды решений хранятся в ветках репозиториев (**branches**), а зафиксированные релизы ушедшие в сборку помечаются тегами (**tags**) с указанием версии.	

Релизный цикл программного обеспечения у всех разработчиков имеет разную длительность: кто-то «собирается» в CI конвейере 10 раз в день, кто-то 1 раз в месяц. В ситуации, когда разработка длится долгое время без проверки сборки на безопасность в конвейере, присутствует риск, что на этапе сборки может возникнуть слишком большое количество срабатываний систем безопасности, из-за чего релиз может быть отложен (или даже сорван), поэтому важно отслеживать безопасность исходного кода в процессе его написания, чтобы исправить возникшую проблему «на лету».	

Во избежание подобных ситуаций в системе CodeScoring реализован механизм непрерывного мониторинга (**Continuous Monitoring**) рисков за счет интеграции со всеми обозначенными выше системами хранения репозиториев. Система проверяет исходный код согласно настраиваемому расписанию сканирования и может сигнализировать о выявленных проблемах в смежные системы, такие как **система управления задачами Jira** или **системы агрегации и оркестрации инцидентов безопасности SOAR/SIEM** или просто уведомить ответственного специалиста по электронной почте: разработчика, инженера, офицера безопасности или юриста (при нарушении лицензионных политик).	

Важно отметить, что непрерывный мониторинг тэгов репозиториев с зафиксированными релизами особенно полезен в процессе безопасной разработки, так как, со временем, в сторонних компонентах также выявляются уязвимости, которые необходимо устранять.	

**Лучшие практики**: применять режим непрерывного мониторинга для всех программных продуктов с релизным циклом более одной недели, а также производить проверку выпущенных ранее и находящихся «в полях» сборок.
