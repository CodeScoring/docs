- [English](https://docs.codescoring.ru/agent/scan-dir.en/index.md)

# Сканирование директории

Сканирование директории производится при помощи субкоманды `scan dir`.

При запуске агент:

1. Рекурсивно проходит по всему содержимому указанной директории (если указан конкретный манифест, обрабатывает только его)
1. Идентифицирует файлы манифестов и разбирает их
1. Хеширует каждый файл (при запуске с `--with-hashes`)
1. Формирует запрос к платформе
1. После получения результата показывает суммарную информацию по найденным манифестам, зависимостям, уязвимостям, сработавшим политикам и более подробную информацию по каждой уязвимости и сработавшей политике
1. Дополнительно в текущей директории формируется файл `bom.json`, содержащий полный Software Bill of Materials в формате **CycloneDX**.

В зависимости от результата работы и параметров запуска агент возвращает соответствующий exit code.

По умолчанию агент проходит по содержимому директории рекурсивно (включая вложенные директории). Для нерекурсивного сканирования необходимо добавить параметр `--no-recursion` к команде `scan dir`.

## Пример запуска команды

```
./johnny scan dir . \
--api_token <api_token> \
--api_url <api_url> \
--ignore .tmp --ignore fixtures --ignore .git
```

## Параметры команды

Команда **scan dir** имеет три уникальных параметра, помимо [общих настроек команды сканирования](/agent/scan/#_2):

- `--branch-or-tag` – ссылка на ветку или тег репозитория в формате `^refs/(heads|tags)/.+` (например, `refs/tags/v1.0`);
- `--commit` – указание хэша коммита;
- `--no-recursion` – отключение рекурсивного сканирования каталогов.

Для сводки доступных параметров команды и инструкции по использованию можно вызвать команду с флагом `-h, --help`.
