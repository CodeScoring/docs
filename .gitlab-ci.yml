stages:
  - lint

lint_trailing_spaces:
  stage: lint
  image: alpine:latest
  before_script:
    - apk add --no-cache git grep
  script:
    - echo "üîç Checking for trailing spaces in changed .md files..."
    - FILES=$(git diff --name-only "$CI_MERGE_REQUEST_DIFF_BASE_SHA"...HEAD -- '*.md')

      if [ -z "$FILES" ]; then
        echo "‚ÑπÔ∏è  No .md files changed. Skipping check."
        exit 0
      fi

      echo "üìÑ Changed .md files:"
      echo "$FILES"

      FOUND=false
      for file in $FILES; do
        if grep -n '[[:blank:]]$' "$file"; then
          FOUND=true
        fi
      done

      if [ "$FOUND" = true ]; then
        echo "‚ùå Trailing spaces found in .md files."
        exit 1
      else
        echo "‚úÖ No trailing spaces in changed files."
      fi
  only:
    - merge_requests